(function(c){var d=function(m){var l=m;var b;var n;var p=c(l.piePlaceholder).parents("div.accordion-group").width();var k=c(l.piePlaceholder).parents("div.accordion-group").height();var a=1.1;var o=1.1;this.renderCharts=function(h){n={};b=h;if(!b){var g=c(l.piePlaceholder).kendoChart({theme:"default",dataSource:{transport:{read:{url:jrealtimeServerStatsEndpoint+"?time="+(new Date().getTime())+"&pie=1&init=1",dataType:"json"}}},legend:{position:"top"},seriesDefaults:{labels:{template:"#= kendo.format('{0:P}', percentage)#",visible:true}},series:[{type:"pie",field:"value",categoryField:"source"}],tooltip:{visible:true,template:"${ category }-${ value } "+COM_JREALTIME_USERS+",#=kendo.format('{0:P}',percentage)#"},transitions:true,chartArea:{width:p/a,height:k/o}});var f=c(l.barPlaceholder).kendoChart({theme:c(document).data("kendoSkin")||"default",dataSource:{transport:{read:{url:jrealtimeServerStatsEndpoint+"?time="+(new Date().getTime())+"&init=1",dataType:"json"}},sort:{field:"year",dir:"asc"}},legend:{position:"top"},seriesDefaults:{type:"column",labels:{visible:true,format:"{0:N0} "+COM_JREALTIME_USERS}},series:[{field:"value",name:COM_JREALTIME_USERS},],categoryAxis:{field:"source",labels:{rotation:-25}},valueAxis:{labels:{format:"{0:N0}"}},tooltip:{visible:true,format:"{0:N0} "+COM_JREALTIME_USERS},transitions:true,chartArea:{width:p/o,height:k/o}});setTimeout(function(){c(g).data("kendoChart").options.transitions=false;c(f).data("kendoChart").options.transitions=false},500)}else{var e=b.slice(0);e.splice(0,3);c(l.barPlaceholder).data("kendoChart").dataSource.data(e);c(l.barPlaceholder).data("kendoChart").refresh();e=b.slice(0);e.splice(0,4);c(l.piePlaceholder).data("kendoChart").dataSource.data(e);c(l.piePlaceholder).data("kendoChart").refresh()}};this.renderTextData=function(e){var f=c(l.textPlaceHolder);c(f).children().remove();if(typeof(e)==="object"){c(f).append('<div class="statslabel blue"><span class="statslabel_value icon-users">'+e[3]["value"]+'</span><span class="statslabel_text">'+e[3]["source"]+"</span></div>");c(f).append('<div class="statslabel green"><span class="statslabel_value icon-user">'+e[4]["value"]+'</span><span class="statslabel_text">'+e[4]["source"]+"</span></div>");c(f).append('<div class="statslabel yellow"><span class="statslabel_value icon-key">'+e[5]["value"]+'</span><span class="statslabel_text">'+e[5]["source"]+"</span></div>");c(f).append('<div id="placeholder_realtimemap"></div>')}};this.renderUserlistStats=function(e){var f=c(l.usersPlaceHolder);c(f).children().remove();if(e){if(e[0].constructor==Array&&e[0].length){c.each(e[0],function(j,x){var h=x.nowpage.match(/\?.+/)?"&":"?";if(!x.name){if(x.current_name){x.name=x.current_name}else{x.name=""}}if(!x.usertype){x.usertype=""}var w="<td>"+x.name+"</td>";var i="<td>"+x.username+"</td>";var z="<td>"+x.usertype+"</td>";var v="<td>"+x.lastupdatetime+"</td>";var g="<td>"+x.geolocation+' <img src="'+jrealtimeBaseURI+"administrator/components/com_jrealtimeanalytics/images/flags/"+x.geolocation.toLowerCase()+'.png"/></td>';var y='<td><a class="preview badge badge-info" title="'+x.nowpage+'" href="'+encodeURI(x.nowpage)+h+'notrack=1">'+x.nowpage+"</a></td>";c(f).append("<tr>"+w+i+z+v+g+y+"</tr>")})}}};this.renderPerPagesStats=function(e){var f=c(l.perpagePlaceHolder);c(f).children().remove();if(e){if(e[1].constructor==Array&&e[1].length){c.each(e[1],function(g,s){var j=s.nowpage.match(/\?.+/)?"&":"?";var h='<td class="large"><a class="preview badge badge-info" title="'+s.nowpage+'" href="'+encodeURI(s.nowpage)+j+'notrack=1" target="_blank">'+s.nowpage+"</a></td>";var t='<td class="little fixed">'+s.numusers+"</td>";var i='<td class="little fixed">'+s.lastvisit+"</td>";c(f).append("<tr>"+h+t+i+"</tr>")})}}};this.renderErrorMessages=function(f){var e='<div class="alert alert-danger"><h4 class="alert-heading">Error</h4><p>'+f+"</p></div>";c("#system-message-container").append(e)};this.redrawCharts=function(){var e=c(l.piePlaceholder).parents("div.accordion-group").width();var f=c(l.piePlaceholder).parents("div.accordion-group").height();c(l.piePlaceholder).data("kendoChart").options.chartArea.width=e/a;c(l.barPlaceholder).data("kendoChart").options.chartArea.width=e/o;c(l.piePlaceholder).data("kendoChart").options.chartArea.height=f/a;c(l.barPlaceholder).data("kendoChart").options.chartArea.height=f/a;c(l.piePlaceholder).data("kendoChart").refresh(true);c(l.barPlaceholder).data("kendoChart").refresh(true)};this.renderMap=function(e){c("#placeholder_realtimemap").vectorMap({map:"world_en",backgroundColor:"#FFFFFF",color:"#DEDEDE",hoverOpacity:0.7,selectedColor:"#666666",enableZoom:false,showTooltip:true,values:e[2],scaleColors:["#B4D6E6","#4B97BA"],normalizeFunction:"polynomial",onLabelShow:function(i,f,g,h){f.text(g+": "+h)}});if(window.ActiveXObject||window.MSInputMethodContext){c(window).trigger("resize")}}};window.JRealtimeViewRealtimestats=d})(jQuery);