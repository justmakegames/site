(function(b){var a=function(c,h){var f;var d;var g;var i=function(){b.fn.extend({getPath:function(){var v,w,n=this;while(n.length){var o=n[0];var k=o.localName||o.nodeName.toLowerCase();var p=o.className;if(p){p=p.replace(/\s{2,}/g," ");p=p.trim()}if(!k){break}k=k.toLowerCase();if(k=="#document"){break}if(p&&k=="body"){var u=p.split(" ");u=u.filter(function(y,x){if(y.match(/visualstyles_active|visualstyles_padded|com_|view-|layout-|-layout|task-|-task|itemid-/g)){return false}else{return true}});if(u.length){k+="."+u.join(".")}}else{if(p){var u=p.split(" ");u=u.filter(function(y,x){if(y.match(/vs-highlight/g)||y.match(/vs-pre-highlight/g)){return false}else{return true}});if(u.length){k+="."+u.join(".")}}}var t=n.parent();var r=t.children(k);if(r.length>1){var m=t.children();var q=m.index(o)+1;if(q>=1){k+=":nth-child("+q+")"}}v='<span class="vs-label-badge-primary vs-xs-small">'+k+"</span>"+(v?'<span class="vs-label-badge-default">></span>'+v:"");w=k+(w?">"+w:"");n=t}var s=b("#vs_state").val();if(s){w+=":"+s;v+='<span class="vs-label-badge-warning vs-xs-small">:'+s+"</span>"}var l={selector:w,html:v};return l}})};var e=function(){var k=b.Deferred(function(l){b.ajax({type:"POST",url:jrealtimeBaseURI+"index.php?option=com_jrealtimeanalytics&task=stream.saveEntity&format=json",dataType:"json",context:this,async:true,data:{resource:"heatmapclick",clicked_element:d,nowpage:b(location).attr("href")}}).done(function(m,o,n){if(m.storing&&m.storing.length){l.reject(m,o);return false}l.resolve(m)}).fail(function(n,p,o){var m=p[0].toUpperCase()+p.slice(1);l.reject("-"+m+"- "+o)})}).promise();k.then(function(l){if(c.enable_debug){console.log(l)}},function(l,m){b.each(l.storing,function(n,o){h.showDebugMsgs(o.corefile,o.details)})})};this.startListening=function(){b("body").on("click.jrealtimeEvents",function(k){f=k.target;var m=b(f).width();if(m>c.heatmap_max_valid_width){return}var l=b(f).height();if(l>c.heatmap_max_valid_height){return}g=b(f).getPath();d=g.selector;e()})};(function j(){i()}).call(this)};window.JRealtimeHeatmap=a;new a()})(jQuery);